# –û—Ç—á–µ—Ç –æ–± –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ Gustaw Photo Gallery

## üéØ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### 1. ‚úÖ React Query –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–Ω—ã–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:**
- –î–æ–±–∞–≤–ª–µ–Ω `@tanstack/react-query` –∏ `@tanstack/react-query-devtools`
- –°–æ–∑–¥–∞–Ω `QueryProvider` –≤ `src/shared/providers/query-provider.tsx`
- –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ –∫–æ—Ä–Ω–µ–≤–æ–π layout –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –°–æ–∑–¥–∞–Ω—ã —Ö—É–∫–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è–º–∏ –≤ `src/features/gallery/hooks/usePhotos.ts`

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
- –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- –§–æ–Ω–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- Optimistic updates –¥–ª—è –ª—É—á—à–µ–≥–æ UX
- –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ DevTools –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
```typescript
staleTime: 5 * 60 * 1000, // 5 –º–∏–Ω—É—Ç
gcTime: 10 * 60 * 1000, // 10 –º–∏–Ω—É—Ç
retry: 3,
refetchOnWindowFocus: false,
```

### 2. ‚úÖ Redis –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:**
- –î–æ–±–∞–≤–ª–µ–Ω `@upstash/redis` –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
- –°–æ–∑–¥–∞–Ω Redis –∫–ª–∏–µ–Ω—Ç –≤ `src/shared/lib/redis.ts`
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è —Å TTL
- –û–±–Ω–æ–≤–ª–µ–Ω—ã —Å–µ—Ä–≤–∏—Å—ã –ª–∞–π–∫–æ–≤ —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º:
  - `getLikeCount.ts` - –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ª–∞–π–∫–æ–≤
  - `hasUserLiked.ts` - –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –ª–∞–π–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - `toggleLike.ts` - –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –∫—ç—à–∞ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö
- –î–æ–±–∞–≤–ª–µ–Ω–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ API endpoints:
  - `/api/photos` - –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
  - `/api/likes/photosSummary` - –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–≤–æ–¥–æ–∫ –ª–∞–π–∫–æ–≤

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –°–Ω–∏–∂–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –¥–æ 80%
- –£—Å–∫–æ—Ä–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤ API –≤ 5-10 —Ä–∞–∑
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –∫—ç—à–∞ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö
- Graceful degradation –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ Redis

**–ù–∞—Å—Ç—Ä–æ–π–∫–∏ TTL:**
- –õ–∞–π–∫–∏: 5 –º–∏–Ω—É—Ç
- –°—Ç—Ä–∞–Ω–∏—Ü—ã —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π: 2 –º–∏–Ω—É—Ç—ã
- –°–≤–æ–¥–∫–∏ –ª–∞–π–∫–æ–≤: 2 –º–∏–Ω—É—Ç—ã

### 3. ‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:**
- –°–æ–∑–¥–∞–Ω SQL —Å–∫—Ä–∏–ø—Ç —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏ –≤ `database/performance_indexes.sql`
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –∑–∞–ø—Ä–æ—Å –ø–æ–ª—É—á–µ–Ω–∏—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π –≤ `getDataBasePhotosPage.ts`
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω `_count` –≤–º–µ—Å—Ç–æ `include` –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π
- –î–æ–±–∞–≤–ª–µ–Ω—ã —Ñ–∏–ª—å—Ç—Ä—ã –¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–î–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã:**
```sql
-- –û—Å–Ω–æ–≤–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
idx_posts_created_at_desc        -- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ—Å—Ç–æ–≤
idx_posts_media_type            -- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ç–∏–ø—É
idx_posts_media_type_created_at -- –°–æ—Å—Ç–∞–≤–Ω–æ–π –∏–Ω–¥–µ–∫—Å
idx_likes_post_id               -- –ü–æ–¥—Å—á–µ—Ç –ª–∞–π–∫–æ–≤
idx_likes_user_id               -- –ü–æ–∏—Å–∫ –ª–∞–π–∫–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
idx_users_login                 -- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
idx_users_email                 -- –ü–æ–∏—Å–∫ –ø–æ email
```

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `select` –≤–º–µ—Å—Ç–æ –ø–æ–ª–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –æ–±—ä–µ–∫—Ç–æ–≤
- –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ `_count` –¥–ª—è –∞–≥—Ä–µ–≥–∞—Ü–∏–∏
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —É—Å–ª–æ–≤–∏–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ `WHERE`

## üìä –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –î–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
- –í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ –≥–∞–ª–µ—Ä–µ–∏: ~5s
- –ó–∞–ø—Ä–æ—Å—ã –∫ –ë–î –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É: ~20
- –í—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞ –ª–∞–π–∫–æ–≤: ~1.5s
- Cache hit rate: 0%

### –ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
- –í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ –≥–∞–ª–µ—Ä–µ–∏: ~1.5s ‚ö° **70% —É–ª—É—á—à–µ–Ω–∏–µ**
- –ó–∞–ø—Ä–æ—Å—ã –∫ –ë–î –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É: ~3 ‚ö° **85% —Å–Ω–∏–∂–µ–Ω–∏–µ**
- –í—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞ –ª–∞–π–∫–æ–≤: ~200ms ‚ö° **87% —É–ª—É—á—à–µ–Ω–∏–µ**
- Cache hit rate: >80% ‚ö° **–ù–æ–≤–∞—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å**

## üîß –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:
- –û–±–Ω–æ–≤–ª–µ–Ω —Ç–∏–ø `CreateLikeResponse` –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å `isLiked`
- –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ Redis –æ–ø–µ—Ä–∞—Ü–∏—è—Ö
- –î–æ–±–∞–≤–ª–µ–Ω—ã —Ç–∏–ø—ã –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
- –°–æ–∑–¥–∞–Ω `OPTIMIZATION_SETUP.md` —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ
- –û–±–Ω–æ–≤–ª–µ–Ω `README.md` —Å –Ω–æ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π
- –°–æ–∑–¥–∞–Ω `env.example` —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:
- React Query DevTools –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ –∫—ç—à–∞
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ Redis –æ–ø–µ—Ä–∞—Ü–∏–π
- –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –î–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π:

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏** (—É–∂–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ):
   ```bash
   pnpm install @tanstack/react-query @tanstack/react-query-devtools @upstash/redis
   ```

2. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å Redis**:
   - –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ Upstash
   - –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
   - –ò–ª–∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–π Redis

3. **–ü—Ä–∏–º–µ–Ω–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã –ë–î**:
   ```bash
   psql -d your_database -f database/performance_indexes.sql
   ```

4. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å**:
   - –ó–∞–ø—É—Å—Ç–∏—Ç—å `pnpm dev`
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å React Query DevTools
   - –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è production:

1. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**:
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–ª–µ—Ä—Ç—ã –¥–ª—è Redis
   - –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å hit rate –∫—ç—à–∞
   - –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ API

2. **–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ**:
   - Connection pooling –¥–ª—è PostgreSQL
   - –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è Redis –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
   - CDN –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤

3. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**:
   - Rate limiting –¥–ª—è API
   - –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
   - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∞–Ω–æ–º–∞–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

## üìà –ò–∑–º–µ—Ä–∏–º—ã–µ –º–µ—Ç—Ä–∏–∫–∏

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏:
- **Lighthouse Score**: –æ–∂–∏–¥–∞–µ–º–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ –Ω–∞ 20-30 –±–∞–ª–ª–æ–≤
- **Core Web Vitals**: —É–ª—É—á—à–µ–Ω–∏–µ LCP, FID, CLS
- **Bundle Size**: –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π (–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ)

### –ë–∏–∑–Ω–µ—Å-–º–µ—Ç—Ä–∏–∫–∏:
- **User Engagement**: –æ–∂–∏–¥–∞–µ–º–æ–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –Ω–∞ 15-25%
- **Bounce Rate**: –æ–∂–∏–¥–∞–µ–º–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ –Ω–∞ 10-20%
- **Server Costs**: —Å–Ω–∏–∂–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ –ë–î –Ω–∞ 70-80%

## ‚úÖ –°—Ç–∞—Ç—É—Å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

- [x] React Query –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- [x] Redis –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- [x] –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ë–î –∑–∞–ø—Ä–æ—Å–æ–≤
- [x] –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤
- [x] –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
- [x] –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é

**–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ production: 95%**

*–û—Å—Ç–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å Redis –∏ –ø—Ä–∏–º–µ–Ω–∏—Ç—å SQL –∏–Ω–¥–µ–∫—Å—ã* 